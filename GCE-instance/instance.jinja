resources:
- name: {{ properties["name"] }}
  type: compute.v1.instance
  properties:
    name: {{ properties["name"] }}
    {% if properties["tags"] %}
    tags:
      items:
    {% for tag in properties["tags"] %}
      - {{ tag }}
    {% endfor %}
    {% endif %}
    machineType: projects/{{ env["project"] }}/zones/{{ properties["zone"] }}/machineTypes/{{ properties["machineType"] }}
    zone: {{ properties["zone"] }}
    networkInterfaces:
    {% for eth in properties["networkInterfaces"] %}
    - network: projects/{{ env["project"] }}/global/networks/{{ eth["network"] }}
      subnetwork: projects/{{ env["project"] }}/regions/{{ properties["region"] }}/subnetworks/{{ eth["subnetwork"] }}
      accessConfigs:
        {% if eth["natIP"] %}
        natIP: {{ eth["natIP"] }}
        {% endif %}
        {% if eth["ptr"] %}
        setPublicPtr: true
        publicPtrDomainName: {{ eth["ptrName"] }}
        {% endif %}
    {% endfor %}
    disks:
    - boot: true
      autoDelete: {{ properties["autoDelete"] }}
      initializeParams:
        {% if properties["sourceSnapshot"] %}
        sourceSnapshot: {{ properties["sourceSnapshot"] }}
        {% else %}
        sourceImage: {{ properties["image"] }}
        {% endif %}
        diskSizeGb: {{ properties["diskSize"] }}
        diskType: /zones/{{ properties["zone"] }}/diskTypes/{{ properties["diskType"] }}
    {% if properties["addDisks"] %}
    {% for disk in properties["addDisks"] %}
    - $(ref
