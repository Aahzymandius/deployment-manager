resources:
- name: {{ properties["name"] }}
  type: compute.v1.instance
  properties:
    {% if properties["networkTag"] %}
    tags:
      items:
      - {{ properties["networkTag"] }}
    {% endif %}
    {% if properties["machineType"] %}
    machineType: zones/{{ properties["zone"] }}/machineTypes/{{ properties["machineType"] }}
    {% endif %}
    zone: {{ properties["zone"] }}
    disks:
    - boot: true
      autoDelete: true
      initializeParams:
        {% if properties["sourceImage"] %}
        sourceImage: {{ properties["sourceImage"] }}
        {% else %}
        sourceImage: projects/debian-cloud/global/images/family/debian-9
        {% endif %}
        diskSizeGb: 10
    networkInterfaces:
    - network: projects/{{ properties["hostProject"] }}/global/networks/{{ properties["network"] }}
      subnetwork: projects/{{ properties["hostProject"] }}/regions/us-central1/subnetworks/{{ properties["subnetwork"] }}
      {% if properties["staticIp"] %}
      accessConfigs:
        kind: compute#accessConfig
        name: External NAT
        natIP: {{ properties["staticIp"] }}
      {% endif %}
    metadata:
      items:
      - key: startup-script
        value: "#! /bin/bash\n\napt-get update\napt-get -y install nmap\napt-get -y install kubectl\napt-get -y install apache2-utils\napt-get install dnsutils"
      - key: enable-oslogin
        value: true
